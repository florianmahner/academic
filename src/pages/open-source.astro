---
import BaseLayout from '../layouts/BaseLayout.astro';
import RepoCard from '../components/blocks/RepoCard.astro';
import Container from '../components/layout/Container.astro';
import Grid from '../components/layout/Grid.astro';
import repos from '../content/repositories.json';
import { config } from '../config';

const title = `Open Source | ${config.site.title}`;

// Sort by stars (highest first)
const sortedRepos = [...repos.repositories].sort((a, b) => (b.stars || 0) - (a.stars || 0));
---

<BaseLayout title={title} description="Open source tools and libraries">
  <article class="opensource-page">
    <Container>
      <header class="page-header" data-animate="fade-up">
        <h1>Open Source</h1>
      </header>

      <Grid cols={2} gap="sm" data-animate="stagger">
        {sortedRepos.map(repo => (
          <RepoCard
            name={repo.name}
            description={repo.description}
            url={repo.url}
            language={repo.language}
            stars={repo.stars}
            forks={repo.forks}
          />
        ))}
      </Grid>

      <p class="view-all" data-animate="fade">
        <a href={`https://github.com/${repos.github_user}`} target="_blank" rel="noopener noreferrer">
          View all on GitHub &rarr;
        </a>
      </p>
    </Container>
  </article>
</BaseLayout>

<style>
  .opensource-page {
    padding: var(--space-8) 0;
  }
</style>
