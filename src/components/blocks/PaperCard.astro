---
/**
 * PaperCard Component
 *
 * Display academic publication with preview, metadata, and links.
 * Composes MediaCard primitive with publication-specific additions.
 */
import MediaCard from '../primitives/MediaCard.astro';
import AuthorList from '../primitives/AuthorList.astro';
import ActionLink from '../primitives/ActionLink.astro';

interface Props {
  title: string;
  authors: string[];
  venue?: string;
  year?: number;
  preview?: string;
  pdf?: string;
  html?: string;
  code?: string;
  abbr?: string;
  highlightAuthor?: string;
  compact?: boolean;
  class?: string;
}

const {
  title,
  authors,
  venue,
  year,
  preview,
  pdf,
  html,
  code,
  abbr,
  highlightAuthor = 'Mahner',
  compact = false,
  class: className,
} = Astro.props;

const primaryLink = pdf || html;
---

<MediaCard
  image={compact ? undefined : preview}
  imageAlt={title}
  title={title}
  href={primaryLink}
  external={true}
  class:list={['paper-card', { 'paper-card--compact': compact }, className]}
>
  <Fragment slot="meta">
    {venue && <span class="paper-venue">{venue}</span>}
    {venue && year && <span class="paper-sep">Â·</span>}
    {year && <span class="paper-year">{year}</span>}
    {abbr && <span class="paper-abbr">{abbr}</span>}
  </Fragment>

  <Fragment slot="subtitle">
    <AuthorList authors={authors} highlight={highlightAuthor} />
  </Fragment>

  <Fragment slot="links">
    {pdf && <ActionLink href={pdf} label="PDF" icon="external" />}
    {html && <ActionLink href={html} label="Web" icon="globe" />}
    {code && <ActionLink href={code} label="Code" icon="code" />}
  </Fragment>
</MediaCard>

<style>
  /* Publication-specific styling only */
  .paper-venue {
    color: var(--color-accent);
    font-weight: var(--font-weight-medium);
  }

  .paper-year {
    color: var(--color-text-muted);
  }

  .paper-sep {
    color: var(--color-text-muted);
    opacity: 0.5;
  }

  .paper-abbr {
    padding: 2px 6px;
    background: var(--color-accent);
    color: white;
    border-radius: var(--radius-sm);
    font-size: var(--font-size-xs);
    font-weight: var(--font-weight-medium);
  }

  /* Compact mode */
  .paper-card--compact :global(.media-card-title) {
    font-size: var(--font-size-sm);
    margin-bottom: var(--space-1);
  }

  .paper-card--compact :global(.media-card-subtitle) {
    font-size: var(--font-size-xs);
    margin-bottom: var(--space-2);
  }

  .paper-card--compact :global(.media-card-meta) {
    margin-bottom: var(--space-1);
  }

  .paper-card--compact :global(.media-card-links) {
    gap: var(--space-2);
  }
</style>
