---
/**
 * Theme Styles Component
 * Generates CSS custom properties from config
 * Include this in your <head> to apply theme customization
 *
 * Performance optimizations:
 * - Preconnect to Google Fonts origins
 * - Uses display=swap to avoid FOIT
 * - Only loads weights that are used (400, 500, 600)
 */
import { config } from '../config';

const { theme } = config;

// Generate Google Fonts URL from config - only load necessary weights
const fonts = Object.values(theme.fonts).filter((v, i, a) => a.indexOf(v) === i);
const fontsUrl = `https://fonts.googleapis.com/css2?${fonts.map(f => `family=${f.replace(/ /g, '+')}:wght@400;500;600`).join('&')}&display=swap`;
---

<!-- DNS prefetch and preconnect for faster font loading -->
<link rel="dns-prefetch" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />

<!-- Load fonts with swap strategy -->
<link href={fontsUrl} rel="stylesheet" media="print" onload="this.media='all'" />
<noscript><link href={fontsUrl} rel="stylesheet" /></noscript>

<style define:vars={{
  accentLight: theme.accentLight,
  accentDark: theme.accentDark,
  fontBody: theme.fonts.body,
  fontHeading: theme.fonts.heading,
  fontUi: theme.fonts.ui,
  fontMono: theme.fonts.mono,
  contentWidth: theme.contentWidth,
}}>
  :root {
    /* Accent colors from config */
    --color-accent: var(--accentLight);
    --color-accent-hover: color-mix(in srgb, var(--accentLight) 85%, black);

    /* Fonts from config */
    --font-body: var(--fontBody), system-ui, sans-serif;
    --font-heading: var(--fontHeading), system-ui, sans-serif;
    --font-ui: var(--fontUi), system-ui, sans-serif;
    --font-mono: var(--fontMono), 'SF Mono', monospace;

    /* Content width from config */
    --content-max-width: var(--contentWidth);
  }

  [data-theme="dark"] {
    --color-accent: var(--accentDark);
    --color-accent-hover: color-mix(in srgb, var(--accentDark) 85%, white);
  }

  @media (prefers-color-scheme: dark) {
    :root:not([data-theme="light"]) {
      --color-accent: var(--accentDark);
      --color-accent-hover: color-mix(in srgb, var(--accentDark) 85%, white);
    }
  }
</style>
