---
/**
 * Theme Styles Component
 * Generates CSS custom properties from typography presets
 * Include this in your <head> to apply theme customization
 *
 * OPTIMIZED: Only loads fonts for the default preset initially (~80KB)
 * Other fonts are loaded dynamically when user switches presets
 * This reduces initial page load by ~400KB
 */
import { getPreset } from '../lib/typography-presets';
import { getDefaultFontUrl } from '../lib/font-loader';
import { config } from '../lib/config';

// Get the default preset from config.yaml (or fallback to editorial-newsreader)
const presetId = config.theme?.defaultPreset || 'editorial-newsreader';
const defaultPreset = getPreset(presetId);

// Override accent colors if specified in config
const accentLight = config.theme?.accentLight || defaultPreset.colors.accentLight;
const accentDark = config.theme?.accentDark || defaultPreset.colors.accentDark;

// Only load fonts for the default preset (other fonts loaded on-demand)
const fontsUrl = getDefaultFontUrl(presetId);
---

<!-- Preconnect for faster font loading -->
<link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />

<!-- Only load default preset fonts initially (others loaded dynamically) -->
<link href={fontsUrl} rel="stylesheet" />

<style define:vars={{
  fontBody: defaultPreset.fonts.body,
  fontHeading: defaultPreset.fonts.heading,
  fontUi: defaultPreset.fonts.ui,
  fontMono: defaultPreset.fonts.mono,
  headingStyle: defaultPreset.styles.headingStyle,
  headingWeight: defaultPreset.styles.headingWeight,
  bodyWeight: defaultPreset.styles.bodyWeight,
  accentLight: accentLight,
  accentDark: accentDark,
}}>
  :root {
    /* Fonts from config (can be overridden by theme selector) */
    --font-body: var(--fontBody), Georgia, serif;
    --font-heading: var(--fontHeading), Georgia, serif;
    --font-ui: var(--fontUi), system-ui, sans-serif;
    --font-mono: var(--fontMono), 'SF Mono', monospace;

    /* Typography style properties from default preset */
    --heading-style: var(--headingStyle);
    --heading-weight: var(--headingWeight);
    --body-weight: var(--bodyWeight);

    /* Accent colors from config.yaml (can be overridden by theme selector) */
    --color-accent-light: var(--accentLight);
    --color-accent-dark: var(--accentDark);
  }

  /* Apply heading style from theme */
  h1, h2, h3, h4, h5, h6 {
    font-style: var(--heading-style);
    font-weight: var(--heading-weight);
  }

  /* Apply body weight from theme */
  body {
    font-weight: var(--body-weight);
  }
</style>
