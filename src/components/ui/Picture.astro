---
interface Props {
  src: string;
  alt: string;
  width?: number;
  height?: number;
  class?: string;
  loading?: 'lazy' | 'eager';
}

const { src, alt, width, height, class: className, loading = 'lazy' } = Astro.props;

// Convert .gif to .webp for modern browsers
const webpSrc = src.replace('.gif', '.webp');
const hasWebp = !src.includes('http');
---

{hasWebp ? (
  <picture class={className}>
    <source srcset={webpSrc} type="image/webp" />
    <img
      src={src}
      alt={alt}
      width={width}
      height={height}
      loading={loading}
      decoding="async"
    />
  </picture>
) : (
  <img
    src={src}
    alt={alt}
    width={width}
    height={height}
    loading={loading}
    decoding="async"
    class={className}
  />
)}
