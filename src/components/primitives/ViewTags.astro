---
/**
 * ViewTags Primitive
 *
 * Tag display component with consistent styling.
 * Supports limiting visible tags and custom styling.
 *
 * @prop tags - Array of tag strings
 * @prop limit - Maximum tags to show (rest shown as "+N more")
 * @prop style - Display style: 'pills' | 'inline' | 'minimal'
 * @prop class - Additional CSS classes
 *
 * Usage in frontmatter:
 *   showTags: true
 *   tagLimit: 3
 *   tagStyle: "pills"  # or "inline", "minimal"
 */

interface Props {
  tags: string[];
  limit?: number;
  style?: 'pills' | 'inline' | 'minimal';
  class?: string;
}

const { tags, limit, style = 'pills', class: className } = Astro.props;

// Limit tags if specified
const visibleTags = limit ? tags.slice(0, limit) : tags;
const hiddenCount = limit ? Math.max(0, tags.length - limit) : 0;
---

{tags.length > 0 && (
  <div class:list={['view-tags', `view-tags--${style}`, className]}>
    {visibleTags.map(tag => (
      <span class="view-tag">{tag}</span>
    ))}
    {hiddenCount > 0 && (
      <span class="view-tag view-tag--more">+{hiddenCount}</span>
    )}
  </div>
)}

<style>
  .view-tags {
    display: flex;
    flex-wrap: wrap;
    gap: var(--view-tag-gap);
  }

  .view-tag {
    font-size: var(--view-tag-size);
    color: var(--view-tag-color);
    white-space: nowrap;
  }

  /* Pills style (default) */
  .view-tags--pills .view-tag {
    padding: var(--view-tag-padding);
    background: var(--view-tag-bg);
    border-radius: var(--view-tag-radius);
  }

  .view-tags--pills .view-tag--more {
    color: var(--color-text-muted);
    font-style: italic;
  }

  /* Inline style (comma-separated) */
  .view-tags--inline {
    gap: 0;
  }

  .view-tags--inline .view-tag {
    padding: 0;
    background: none;
  }

  .view-tags--inline .view-tag:not(:last-child)::after {
    content: ', ';
  }

  .view-tags--inline .view-tag--more::before {
    content: ' ';
  }

  /* Minimal style (just text, subtle) */
  .view-tags--minimal {
    gap: var(--space-2);
  }

  .view-tags--minimal .view-tag {
    padding: 0;
    background: none;
    opacity: 0.7;
  }

  .view-tags--minimal .view-tag::before {
    content: '#';
    opacity: 0.5;
  }

  .view-tags--minimal .view-tag--more::before {
    content: '';
  }
</style>
