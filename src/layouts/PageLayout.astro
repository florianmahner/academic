---
/**
 * Page Layout
 * Simple layout for custom pages with title and content
 * Supports variants: default, wide, minimal, full
 */

import BaseLayout from './BaseLayout.astro';
import { config } from '../config';
import type { CollectionEntry } from 'astro:content';

interface Props {
  page: CollectionEntry<'pages'>;
}

const { page } = Astro.props;
const { Content } = await page.render();

const {
  title,
  description,
  layout = 'default'
} = page.data;

// Map layout to variant for styling
const variant = layout;

const pageTitle = `${title} | ${config.site.title}`;
---

<BaseLayout title={pageTitle} description={description}>
  <article class:list={['page-article', `page-variant-${variant}`]}>
    <div class:list={['container', { 'container-wide': variant === 'wide' }]}>
      {variant !== 'minimal' && (
        <header class="page-header" data-animate="fadeIn">
          <h1 class="page-title">{title}</h1>
          {description && (
            <p class="page-description">{description}</p>
          )}
        </header>
      )}

      <div class="page-content" data-animate="slideUp">
        <Content />
      </div>
    </div>
  </article>

  <style>
    /* ============================================
       Page Article Container
       ============================================ */
    .page-article {
      padding: var(--content-top-padding) 0;
    }

    /* Minimal variant - reduce top padding */
    .page-variant-minimal {
      padding-top: var(--space-8);
    }

    /* ============================================
       Page Header
       ============================================ */
    .page-header {
      margin-bottom: var(--space-10);
      max-width: 800px;
    }

    .page-title {
      font-size: var(--font-size-3xl);
      font-family: var(--font-heading);
      font-weight: var(--heading-weight);
      font-style: var(--heading-style);
      line-height: var(--line-height-tight);
      color: var(--color-text);
      margin: 0 0 var(--space-4);
    }

    /* Minimal variant - smaller title */
    .page-variant-minimal .page-title {
      font-size: var(--font-size-2xl);
      margin-bottom: var(--space-6);
    }

    .page-description {
      font-size: var(--font-size-lg);
      font-family: var(--font-body);
      line-height: var(--line-height-relaxed);
      color: var(--color-text-secondary);
      margin: 0;
    }

    /* ============================================
       Page Content
       ============================================ */
    .page-content {
      font-family: var(--font-body);
      font-size: var(--font-size-base);
      line-height: var(--line-height-relaxed);
      color: var(--color-text);
    }

    /* Default variant - constrained width */
    .page-variant-default .page-content {
      max-width: 800px;
    }

    /* Wide variant - full container width */
    .page-variant-wide .page-content {
      max-width: none;
    }

    .container-wide {
      max-width: 1200px;
    }

    /* Minimal variant - very constrained */
    .page-variant-minimal .page-content {
      max-width: 720px;
    }

    /* ============================================
       Typography Styles for Content
       ============================================ */
    .page-content :global(h2) {
      font-size: var(--font-size-2xl);
      font-family: var(--font-heading);
      font-weight: var(--heading-weight);
      font-style: var(--heading-style);
      line-height: var(--line-height-tight);
      margin-top: var(--space-10);
      margin-bottom: var(--space-4);
      color: var(--color-text);
    }

    .page-content :global(h2:first-child) {
      margin-top: 0;
    }

    .page-content :global(h3) {
      font-size: var(--font-size-xl);
      font-family: var(--font-heading);
      font-weight: var(--font-weight-medium);
      line-height: var(--line-height-tight);
      margin-top: var(--space-8);
      margin-bottom: var(--space-3);
      color: var(--color-text);
    }

    .page-content :global(h4) {
      font-size: var(--font-size-lg);
      font-family: var(--font-body);
      font-weight: var(--font-weight-medium);
      margin-top: var(--space-6);
      margin-bottom: var(--space-3);
      color: var(--color-text);
    }

    .page-content :global(p) {
      margin-bottom: var(--space-6);
    }

    .page-content :global(a) {
      color: var(--color-accent);
      text-decoration: none;
      background: none;
      transition: opacity var(--transition-fast);
    }

    .page-content :global(a:hover) {
      opacity: 0.7;
    }

    .page-content :global(ul),
    .page-content :global(ol) {
      margin: var(--space-6) 0;
      padding-left: var(--space-6);
    }

    .page-content :global(li) {
      margin-bottom: var(--space-3);
    }

    .page-content :global(blockquote) {
      margin: var(--space-8) 0;
      padding: var(--space-4) var(--space-6);
      border-left: 3px solid var(--color-accent);
      background: var(--color-bg-alt);
      border-radius: var(--radius-md);
      font-style: italic;
      color: var(--color-text-secondary);
    }

    .page-content :global(code) {
      font-family: var(--font-mono);
      font-size: 0.9em;
      padding: 0.2em 0.4em;
      background: var(--color-bg-alt);
      border-radius: var(--radius-sm);
      color: var(--color-accent);
    }

    .page-content :global(pre) {
      margin: var(--space-6) 0;
      padding: var(--space-4);
      background: var(--color-bg-alt);
      border-radius: var(--radius-md);
      overflow-x: auto;
      border: 1px solid var(--color-border);
    }

    .page-content :global(pre code) {
      padding: 0;
      background: none;
      color: var(--color-text);
    }

    .page-content :global(img) {
      margin: var(--space-8) 0;
      border-radius: var(--radius-md);
      border: 1px solid var(--color-border);
    }

    .page-content :global(table) {
      width: 100%;
      margin: var(--space-8) 0;
      border-collapse: collapse;
    }

    .page-content :global(th),
    .page-content :global(td) {
      padding: var(--space-3) var(--space-4);
      text-align: left;
      border-bottom: 1px solid var(--color-border);
    }

    .page-content :global(th) {
      font-weight: var(--font-weight-medium);
      color: var(--color-text);
      background: var(--color-bg-alt);
    }

    .page-content :global(hr) {
      margin: var(--space-10) 0;
      border: none;
      border-top: 1px solid var(--color-border);
    }

    /* ============================================
       Responsive
       ============================================ */
    @media (max-width: 768px) {
      .page-title {
        font-size: var(--font-size-2xl);
      }

      .page-description {
        font-size: var(--font-size-base);
      }

      .page-content :global(h2) {
        font-size: var(--font-size-xl);
      }

      .page-content :global(h3) {
        font-size: var(--font-size-lg);
      }

      .page-content :global(table) {
        display: block;
        overflow-x: auto;
      }
    }
  </style>
</BaseLayout>
